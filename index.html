// Add this inside your <script> tag â€“ full version:
let dragTimeout = null;
let isDragging = false;
let offsetX = 0;
let offsetY = 0;

function startDragCheck(e) {
  const isCtrl = e.ctrlKey || (e.touches && e.touches[0].ctrlKey);
  const startX = (e.touches ? e.touches[0].clientX : e.clientX);
  const startY = (e.touches ? e.touches[0].clientY : e.clientY);
  offsetX = startX - cameraButton.offsetLeft;
  offsetY = startY - cameraButton.offsetTop;

  if (isCtrl) {
    isDragging = true;
    cameraButton.classList.add('drag-ready', 'dragging');
  } else {
    dragTimeout = setTimeout(() => {
      isDragging = true;
      cameraButton.classList.add('drag-ready', 'dragging');
    }, 1000);
  }
}

function doDrag(e) {
  if (!isDragging) return;
  const clientX = e.touches ? e.touches[0].clientX : e.clientX;
  const clientY = e.touches ? e.touches[0].clientY : e.clientY;
  cameraButton.style.left = (clientX - offsetX) + 'px';
  cameraButton.style.top = (clientY - offsetY) + 'px';
  cameraButton.style.right = 'auto';
  cameraButton.style.bottom = 'auto';
}

function stopDrag() {
  clearTimeout(dragTimeout);
  isDragging = false;
  cameraButton.classList.remove('drag-ready', 'dragging');
  localStorage.setItem('cameraBtnPos', JSON.stringify({
    left: cameraButton.style.left,
    top: cameraButton.style.top
  }));
}

// ðŸ§  Block toggle click while dragging
cameraButton.addEventListener('click', (e) => {
  if (isDragging) {
    e.stopImmediatePropagation();
    e.preventDefault();
  }
}, true);

// Event listeners
cameraButton.addEventListener('mousedown', startDragCheck);
cameraButton.addEventListener('touchstart', startDragCheck, { passive: false });
window.addEventListener('mousemove', doDrag);
window.addEventListener('touchmove', doDrag, { passive: false });
window.addEventListener('mouseup', stopDrag);
window.addEventListener('touchend', stopDrag);
